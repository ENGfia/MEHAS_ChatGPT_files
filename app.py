
import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt

# Load the real data
@st.cache_data
def load_data():
    data = [{'Task': 'Design', 'Week': '2025-07-06', 'Scheduled Hours': 2.5, 'Max Hours': 100.0}, {'Task': 'Design', 'Week': '2025-07-13', 'Scheduled Hours': 160.0, 'Max Hours': 100.0}, {'Task': 'Design', 'Week': '2025-07-20', 'Scheduled Hours': 0.0, 'Max Hours': 100.0}, {'Task': 'Design', 'Week': '2025-07-27', 'Scheduled Hours': 0.0, 'Max Hours': 100.0}, {'Task': 'Design', 'Week': '2025-08-03', 'Scheduled Hours': 0.0, 'Max Hours': 100.0}, {'Task': 'Design', 'Week': '2025-08-10', 'Scheduled Hours': 0.0, 'Max Hours': 100.0}, {'Task': 'Design', 'Week': '2025-08-17', 'Scheduled Hours': 0.0, 'Max Hours': 100.0}, {'Task': 'Design', 'Week': '2025-08-24', 'Scheduled Hours': 0.0, 'Max Hours': 100.0}, {'Task': 'Design', 'Week': '2025-08-31', 'Scheduled Hours': 0.0, 'Max Hours': 100.0}, {'Task': 'Design', 'Week': '2025-09-07', 'Scheduled Hours': 0.0, 'Max Hours': 100.0}, {'Task': 'Welding', 'Week': '2025-07-06', 'Scheduled Hours': 7.0, 'Max Hours': 40.0}, {'Task': 'Welding', 'Week': '2025-07-13', 'Scheduled Hours': 39.0, 'Max Hours': 40.0}, {'Task': 'Welding', 'Week': '2025-07-20', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Welding', 'Week': '2025-07-27', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Welding', 'Week': '2025-08-03', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Welding', 'Week': '2025-08-10', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Welding', 'Week': '2025-08-17', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Welding', 'Week': '2025-08-24', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Welding', 'Week': '2025-08-31', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Welding', 'Week': '2025-09-07', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'SNK\nMill', 'Week': '2025-07-06', 'Scheduled Hours': 3.0, 'Max Hours': 40.0}, {'Task': 'SNK\nMill', 'Week': '2025-07-13', 'Scheduled Hours': 36.0, 'Max Hours': 40.0}, {'Task': 'SNK\nMill', 'Week': '2025-07-20', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'SNK\nMill', 'Week': '2025-07-27', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'SNK\nMill', 'Week': '2025-08-03', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'SNK\nMill', 'Week': '2025-08-10', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'SNK\nMill', 'Week': '2025-08-17', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'SNK\nMill', 'Week': '2025-08-24', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'SNK\nMill', 'Week': '2025-08-31', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'SNK\nMill', 'Week': '2025-09-07', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'HAAS\nMill', 'Week': '2025-07-06', 'Scheduled Hours': 22.0, 'Max Hours': 80.0}, {'Task': 'HAAS\nMill', 'Week': '2025-07-13', 'Scheduled Hours': 173.5, 'Max Hours': 80.0}, {'Task': 'HAAS\nMill', 'Week': '2025-07-20', 'Scheduled Hours': 8.0, 'Max Hours': 80.0}, {'Task': 'HAAS\nMill', 'Week': '2025-07-27', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'HAAS\nMill', 'Week': '2025-08-03', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'HAAS\nMill', 'Week': '2025-08-10', 'Scheduled Hours': 3.5, 'Max Hours': 80.0}, {'Task': 'HAAS\nMill', 'Week': '2025-08-17', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'HAAS\nMill', 'Week': '2025-08-24', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'HAAS\nMill', 'Week': '2025-08-31', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'HAAS\nMill', 'Week': '2025-09-07', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'Manual\nMachining', 'Week': '2025-07-06', 'Scheduled Hours': 0.0, 'Max Hours': 5.0}, {'Task': 'Manual\nMachining', 'Week': '2025-07-13', 'Scheduled Hours': 2.0, 'Max Hours': 5.0}, {'Task': 'Manual\nMachining', 'Week': '2025-07-20', 'Scheduled Hours': 0.0, 'Max Hours': 5.0}, {'Task': 'Manual\nMachining', 'Week': '2025-07-27', 'Scheduled Hours': 0.0, 'Max Hours': 5.0}, {'Task': 'Manual\nMachining', 'Week': '2025-08-03', 'Scheduled Hours': 0.0, 'Max Hours': 5.0}, {'Task': 'Manual\nMachining', 'Week': '2025-08-10', 'Scheduled Hours': 4.5, 'Max Hours': 5.0}, {'Task': 'Manual\nMachining', 'Week': '2025-08-17', 'Scheduled Hours': 0.0, 'Max Hours': 5.0}, {'Task': 'Manual\nMachining', 'Week': '2025-08-24', 'Scheduled Hours': 0.0, 'Max Hours': 5.0}, {'Task': 'Manual\nMachining', 'Week': '2025-08-31', 'Scheduled Hours': 0.0, 'Max Hours': 5.0}, {'Task': 'Manual\nMachining', 'Week': '2025-09-07', 'Scheduled Hours': 0.0, 'Max Hours': 5.0}, {'Task': 'Lathe', 'Week': '2025-07-06', 'Scheduled Hours': 4.75, 'Max Hours': 40.0}, {'Task': 'Lathe', 'Week': '2025-07-13', 'Scheduled Hours': 7.0, 'Max Hours': 40.0}, {'Task': 'Lathe', 'Week': '2025-07-20', 'Scheduled Hours': 6.0, 'Max Hours': 40.0}, {'Task': 'Lathe', 'Week': '2025-07-27', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Lathe', 'Week': '2025-08-03', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Lathe', 'Week': '2025-08-10', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Lathe', 'Week': '2025-08-17', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Lathe', 'Week': '2025-08-24', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Lathe', 'Week': '2025-08-31', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Lathe', 'Week': '2025-09-07', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Other', 'Week': '2025-07-06', 'Scheduled Hours': 5.0, 'Max Hours': 20.0}, {'Task': 'Other', 'Week': '2025-07-13', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Other', 'Week': '2025-07-20', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Other', 'Week': '2025-07-27', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Other', 'Week': '2025-08-03', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Other', 'Week': '2025-08-10', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Other', 'Week': '2025-08-17', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Other', 'Week': '2025-08-24', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Other', 'Week': '2025-08-31', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Other', 'Week': '2025-09-07', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Assembly', 'Week': '2025-07-06', 'Scheduled Hours': 39.0, 'Max Hours': 80.0}, {'Task': 'Assembly', 'Week': '2025-07-13', 'Scheduled Hours': 320.0, 'Max Hours': 80.0}, {'Task': 'Assembly', 'Week': '2025-07-20', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'Assembly', 'Week': '2025-07-27', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'Assembly', 'Week': '2025-08-03', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'Assembly', 'Week': '2025-08-10', 'Scheduled Hours': 165.0, 'Max Hours': 80.0}, {'Task': 'Assembly', 'Week': '2025-08-17', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'Assembly', 'Week': '2025-08-24', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'Assembly', 'Week': '2025-08-31', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'Assembly', 'Week': '2025-09-07', 'Scheduled Hours': 0.0, 'Max Hours': 80.0}, {'Task': 'Paint', 'Week': '2025-07-06', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Paint', 'Week': '2025-07-13', 'Scheduled Hours': 48.5, 'Max Hours': 20.0}, {'Task': 'Paint', 'Week': '2025-07-20', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Paint', 'Week': '2025-07-27', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Paint', 'Week': '2025-08-03', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Paint', 'Week': '2025-08-10', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Paint', 'Week': '2025-08-17', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Paint', 'Week': '2025-08-24', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Paint', 'Week': '2025-08-31', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'Paint', 'Week': '2025-09-07', 'Scheduled Hours': 0.0, 'Max Hours': 20.0}, {'Task': 'PLC / Trials', 'Week': '2025-07-06', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'PLC / Trials', 'Week': '2025-07-13', 'Scheduled Hours': 306.5, 'Max Hours': 40.0}, {'Task': 'PLC / Trials', 'Week': '2025-07-20', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'PLC / Trials', 'Week': '2025-07-27', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'PLC / Trials', 'Week': '2025-08-03', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'PLC / Trials', 'Week': '2025-08-10', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'PLC / Trials', 'Week': '2025-08-17', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'PLC / Trials', 'Week': '2025-08-24', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'PLC / Trials', 'Week': '2025-08-31', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'PLC / Trials', 'Week': '2025-09-07', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Electrical', 'Week': '2025-07-06', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Electrical', 'Week': '2025-07-13', 'Scheduled Hours': 489.0, 'Max Hours': 40.0}, {'Task': 'Electrical', 'Week': '2025-07-20', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Electrical', 'Week': '2025-07-27', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Electrical', 'Week': '2025-08-03', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Electrical', 'Week': '2025-08-10', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Electrical', 'Week': '2025-08-17', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Electrical', 'Week': '2025-08-24', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Electrical', 'Week': '2025-08-31', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}, {'Task': 'Electrical', 'Week': '2025-09-07', 'Scheduled Hours': 0.0, 'Max Hours': 40.0}]
    df = pd.DataFrame(data)
    df["Week"] = pd.to_datetime(df["Week"])
    return df

df = load_data()

st.title("Resource Scheduling Dashboard")

view = st.radio("Select View", ["Overall Shop Loading", "Individual Task Utilization"])

if view == "Overall Shop Loading":
    summary = df.groupby("Week").agg({"Scheduled Hours": "sum", "Max Hours": "sum"}).reset_index()
    fig, ax = plt.subplots()
    ax.bar(summary["Week"].dt.strftime("%Y-%m-%d"), summary["Max Hours"], label="Max Hours", alpha=0.5)
    ax.bar(summary["Week"].dt.strftime("%Y-%m-%d"), summary["Scheduled Hours"], label="Scheduled Hours", alpha=0.9)
    ax.set_title("Overall Shop Loading")
    ax.set_ylabel("Hours")
    ax.legend()
    plt.xticks(rotation=45)
    st.pyplot(fig)
else:
    task_list = df["Task"].unique()
    selected_task = st.selectbox("Select a Task", task_list)
    task_df = df[df["Task"] == selected_task]
    fig, ax = plt.subplots()
    ax.bar(task_df["Week"].dt.strftime("%Y-%m-%d"), task_df["Max Hours"], label="Max Hours", alpha=0.5)
    ax.bar(task_df["Week"].dt.strftime("%Y-%m-%d"), task_df["Scheduled Hours"], label="Scheduled Hours", alpha=0.9)
    ax.set_title(f"Utilization for: {selected_task}")
    ax.set_ylabel("Hours")
    ax.legend()
    plt.xticks(rotation=45)
    st.pyplot(fig)
